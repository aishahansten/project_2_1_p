2024-01-06

# 실전! 스프링 부트와 JPA 활용1- 웹 애플리케이션 개발

**목차**
---
[프로젝트 환경설정]
- 프로젝트 생성
- 라이브러리 살펴보기
- View 환경설정 (HTML 화면 렌더링용)
- H2 데이터베이스 설치
- JPA와 DB 설정, 동작확인


**프로젝트 생성**
---
[Spring Boot Starter](https://start.spring.io/)
- Project : Gradle-Groovy (Maven 에서 Gradle로 넘어가는 추세; Gradle-Kotlin, Maven 은 교안대로 안됨 )
- Language : Java 
- Spring Boot (Version M5, Snapshot 는 안정화가 아직 안됨, Major는 달라질 수 있음) : 3.2.1
- Group : jpabook
- Artifact : jpashop
- Packaging : Jar
- Java : 17

- Dependencies(어떤 라이브러리들을 의존해서 쓸 것인가)
  - Spring Web (REST API, Spring MVC, Apache Tomcat 내장 - 웹앱 개발 시 필수)
  - Thymeleaf (JSP를 거의 안쓰고 ; 모던 서버사이드 자바 템플릿 엔진)
  - Spring Data JPA (Java Persist API ; Spring Data와 Hibernate를 사용한다)
  - H2 Database ( DB ; MySQL보다 간편설치, 웹앱 실행시 메모리상태 내장에서 실행 가능)
  - Lombok ( 지루하게 반복되는 코드 줄여줌 ; Getter Setter (JAVA))

- -> Generate -> C:\stuudy\에서 jpashop.zip 압축풀기 -> 인텔리제이 open -> stuudy>jpashop>build.gradle 선택해서 open -> 프로젝트 생성 -> build.gradle 에 빌드 정보가 다 적혀있음

- src>main>java>jpabook.jpashop>JpashopApplication 열고 맨 위에 실행 (부분실행하면 안됨) -> "Tomcat started on port 8080 (http) with context path ''" 뜨면 -> localhost:8080 또는 127.0.0.1:8080 Chrome 으로 접속하면 Whitelabel Error page 뜸

- test>java>jpabook.jpashop>JpashopApplicationTests 실행 되는거 확인

- External Library 에 설치 목록 쭉 뜨는것 확인

- Lombok setting
  - Settings > Plugins > Lombok 설치, Settings> Compiler > Annotation Processors > Enable Annotation Processing 체크, Apply, Ok 

- <실행 확인>
- src > main>java>jpabook.jpashop 에 Hello 클래스 생성
```
  package jpabook.jpashop;


  import lombok.Getter;
  import lombok.Setter;

  @Getter @Setter
  public class Hello {

      private String data;
  }
```
- JpashopApplication에서 아래 추가
```
public static void main(String[] args) {

		Hello hello = new Hello();
		hello.setData("hello");
		String data = hello.getData();
		System.out.println("data = " + data);

		SpringApplication.run(JpashopApplication.class, args);
	}
```
- public static void 부분에서 실행하면 data = hello 출력됨 

  - setting 완료!

```code
  plugins {
	id 'java'
	id 'org.springframework.boot' version '3.2.1'
	id 'io.spring.dependency-management' version '1.1.4'
  }

  group = 'jpabook'
  version = '0.0.1-SNAPSHOT'

  java {
    sourceCompatibility = '17'
  }

  configurations {
    compileOnly {
      extendsFrom annotationProcessor
    }
  }

  repositories {
    mavenCentral()
  }

  dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    compileOnly 'org.projectlombok:lombok'
    runtimeOnly 'com.h2database:h2'
    annotationProcessor 'org.projectlombok:lombok'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
  }

  tasks.named('test') {
    useJUnitPlatform()
  }
```

**5. 라이브러리**
---

- Gradle 로 의존관계 setting 함 

- cmd에서 jpashop 폴더로 이동 후 gradlew dependencies 입력하면 의존관계 볼 수 있음

- 인텔리제이에서 오른쪽 메뉴 Gradle 클릭하면 dependency 확인 가능


**6. 서버사이드 렌더링**

- src>main>java>jpabook.jpashop> 에서 HelloController 클래스 생성

```
package jpabook.jpashop;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloController {

    @GetMapping("hello")
    public String hello(Model model){
        model.addAttribute("data", "hello!!!");
        return "hello";
    }
}
```

**7. H2 데이터베이스 설치**
---

- 개발이나 테스트 용도로 가볍고 편리한 DB, 웹 화면 제공

**8. JPA와 DB설정, 동작확인**
---
- resources>application.properties 대신 applications.yml 생성


- db connection 관련된 데이터소스 설정 완료
```
spring:
  datasource:
    url: jdbc:h2:tcp://localhost/~/jpashop;MVCC=TRUE
    username: sa
    password:
    driver-class-name: org.h2.Driver
```

```
jpa:
  hibernate:
    ddl-auto: create
  properties:
    hibernate:
#      show_sql: true
      format_sql: true
```

```
logging:
  level:
    org.hibernate.SQL: debug
```

- springboot> project> springboot> learn > reference docs 

- hibernate, jpa 가 남기는 로그가 디버그 모드 - 생성하는 SQL 이 다 보임 